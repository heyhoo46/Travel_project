<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오름 정보</title>

    <style>
        /* 간단한 레이아웃을 위한 스타일 */
        body {
            display: flex;
            justify-content: space-between;
            padding: 20px;
        }

        /* sidebar 스타일 */
        .sidebar {
            width: 200px;
            border-right: 2px solid #ccc;
            padding-right: 10px;
            margin-right: 20px;
        }

        .sidebar div {
            padding: 10px;
            cursor: pointer;
            margin: 5px 0;
            background-color: #f1f1f1;
        }

        .sidebar div:hover {
            background-color: #ddd;
        }

        /* rightbar 스타일 */
        #rightbar {
            flex-grow: 1;
            padding: 20px;
            border: 2px solid #ccc;
        }

        /* 이미지 스타일 */
        #region-image {
            margin-top: 20px;
        }

        #region-img {
            width: 100%;
            max-width: 300px;
        }
    </style>

    <!-- PapaParse 라이브러리 로드 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
</head>
<body>

    <!-- 사이드바 (지역 목록 클릭 영역) -->
    <div class="sidebar" id="sidebar">
        <h3>지역 선택</h3>
        <!-- 지역 항목들이 동적으로 추가될 곳 -->
    </div>

    
    <!-- 선택된 지역의 정보가 표시될 부분 -->
    <div id="region-info">
        <h3>오름 정보가 여기에 표시됩니다.</h3>
        <p><strong>주소:</strong> <span id="region-address"></span></p>
        <p><strong>영업시간:</strong> <span id="region-hours"></span></p>
        <p><strong>개요:</strong> <span id="region-description"></span></p>
    </div>

    <!-- 이미지를 표시할 부분 -->
    <div class="rightbar" id="region-image">
        <img id="region-img" src="" alt="지역 이미지">
    </div>
    

    <script>
        // CSV 파일을 불러오고 지역명을 추출하여 sidebar에 추가하는 함수
        function loadRegionsFromCSV() {
            Papa.parse('제주도_오름.csv', {
                download: true,  // CSV 파일을 다운로드하여 파싱
                header: true,  // 첫 번째 행을 헤더로 처리
                dynamicTyping: true,  // 데이터 타입 자동 변환
                complete: function(results) {
                    var regions = results.data; // 파싱된 CSV 데이터

                    // sidebar 요소를 가져옴
                    var sidebar = document.getElementById('sidebar');

                    // 각 행에서 'place' 열의 값을 추출하여 sidebar에 추가
                    regions.forEach(function(row) {
                        var regionName = row.place;  // 'place' 열에서 지역명 가져오기
                        if (regionName) {
                            var regionDiv = document.createElement('div');
                            regionDiv.textContent = regionName;
                            regionDiv.addEventListener('click', function() {
                                handleRegionSelection(regionName, row);  // 지역 선택 처리
                            });
                            sidebar.appendChild(regionDiv);
                        }
                    });
                },
                error: function(error) {
                    console.error('CSV 파일을 불러오는 데 오류가 발생했습니다:', error);
                }
            });
        }

        // 페이지가 로드되면 CSV 파일을 불러옴
        window.onload = function() {
            loadRegionsFromCSV();
        };

        // 지역이 선택되었을 때 처리하는 함수
        function handleRegionSelection(regionName, regionData) {
            // 지역명에 해당하는 제목을 동적으로 업데이트
            document.querySelector('#region-info h3').textContent = `${regionName}의 정보`;

            // 주소가 있는 경우에만 표시하거나, 지역명이 주소와 같으면 "주소 데이터가 없습니다." 표시
            if (regionData.address && regionData.address !== regionName) {
                document.getElementById('region-address').textContent = regionData.address;
                document.getElementById('region-address').parentElement.style.display = 'block';  // 주소 항목 표시
            } else {
                document.getElementById('region-address').textContent = "주소 데이터가 없습니다.";  // 주소 데이터가 없거나 지역명과 같으면 표시
                document.getElementById('region-address').parentElement.style.display = 'block';  // 주소 항목 표시
            }

            // 만약 주소가 없고 '주소 데이터가 없습니다.'로 표시된다면 숨기기
            if (!regionData.address || regionData.address === regionName) {
                document.getElementById('region-address').parentElement.style.display = 'none';  // 주소 항목 숨기기
            }

            // 영업시간(bushour)이 있는 경우에만 표시
            if (regionData.bushour) {
                document.getElementById('region-hours').innerHTML = regionData.bushour.replace(/\n/g, "<br>");
            } else {
                document.getElementById('region-hours').parentElement.style.display = 'none';  // 영업시간 항목 숨기기
            }

            // 개요(summary)가 있는 경우에만 표시
            if (regionData.summary) {
            // 마침표를 기준으로 문장을 나누고, 각 문장의 앞뒤 공백을 제거한 후 <p> 태그로 감쌈
            var formattedSummary = regionData.summary.split('.').map(function(sentence) {
                var trimmedSentence = sentence.trim();  // 문장의 앞뒤 공백을 제거
                if (trimmedSentence.length > 0) {
                    return `<p>${trimmedSentence}</p>`;  // 공백이 없으면 <p> 태그로 감싸서 반환
                }
                return '';  // 빈 문장은 제외
            }).join('');  // <p> 태그로 감싸진 문장을 합침

                document.getElementById('region-description').innerHTML = regionData.summary.replace(/\n/g, "<br>");  // 줄 바꿈 처리
            } else {
                document.getElementById('region-description').parentElement.style.display = 'none';  // 개요 항목 숨기기
            }

            // 이미지 경로 설정 (CSV 파일에서 경로 가져오기)
            var imagePath = 'file:///C:/Users/kccistc/Desktop/workspace/jeju_project/오름/${regionName}.png';  // 이미지 경로

            // 이미지를 오른쪽 바에 표시
            var regionImg = document.getElementById('region-img');

            // 이미지가 존재하지 않는 경우에 대한 대체 처리
            var img = new Image();
            img.onload = function() {
                regionImg.src = imagePath;  // 이미지가 있으면 src를 설정
            };
            img.onerror = function() {
                regionImg.src = 'https://via.placeholder.com/300?text=Image+Not+Found';  // 이미지가 없으면 기본 대체 이미지 표시
            };

            img.src = imagePath;  // 이미지를 로드
        }
    </script>

</body>
</html>
